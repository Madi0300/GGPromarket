# GGPromarket — серверная архитектура

## Общая схема

Проект состоит из двух независимых пакетов:

- `client/` — SPA на React Router 7.8, которая загружает данные через loaders.
- `server/` — небольшой сервер на Express 4, который отдаёт JSON и статические медиа.

Фронтенд при разработке проксирует запросы `/api/*` и `/media/*` на `http://localhost:4000`,
поэтому оба процесса нужно запускать параллельно.

```
┌────────────┐      fetch /api/home      ┌──────────────────────┐
│  React UI  │ ───────────────────────▶ │  Express + in-memory │
│ (client)   │      /media/hero/...     │       data store     │
└────────────┘ ◀─────────────────────── └──────────────────────┘
```

## Запуск

```bash
# установить зависимости
cd client && npm install
cd ../server && npm install

# запустить API на 4000 порту
npm run dev

# запустить React-приложение на 5173 порту
cd ../client
npm run dev
```

## Структура `server/`

```
server/
  data/               # JSON-подобные структуры (товары, бренды, hero и т.д.)
  public/media/       # перенесённые маркетинговые изображения
  src/
    app.js            # конфигурация Express, CORS, статические файлы
    index.js          # точка входа (HTTP-сервер)
    routes/index.js   # маршруты /api/*
```

### Основные эндпоинты

| Метод | URL              | Описание                                     |
|-------|------------------|----------------------------------------------|
| GET   | `/api/health`    | health-check                                 |
| GET   | `/api/config`    | шапка: город, телефон, навигация, счётчики   |
| GET   | `/api/home`      | агрегированный payload для главной страницы  |
| GET   | `/api/products`  | полный список товаров + список категорий     |
| GET   | `/api/brands`    | бренды с ссылками и логотипами               |
| GET   | `/api/articles`  | карточки блога                               |
| GET   | `/api/footer`    | ссылки футера, расписание, соцсети           |

Статические изображения доступны по `GET /media/<путь>` и находятся в `server/public/media`.

## Форматы данных

- **Товары** — объекты со свойствами `price`, `availability`, `rating`, `categories`, что
  позволяет в будущем хранить дополнительные атрибуты и подключать БД.
- **Категории** — массив `{ id, title }`, используется фронтендом для фильтров.
- **Hero / Collections / Brands / Articles** — содержат `id` и ссылки, что облегчает
  связь с потенциальной админкой.

## Интеграция с фронтендом

- React Router loaders (`clientLoader`) вызывают `fetchFromApi(request, "/api/..." )`.
- Redux Toolkit больше не содержит мок-данных: в `appSlice` — только пустой initial state.
- Все компоненты (`Hero`, `Goods`, `Brands`, `Icons`, `Collections`, `Articles`, `SEO`,
  `Header`, `Footer`) принимают данные через пропсы и корректно работают с пустыми массивами.

## Медиа

Все маркетинговые изображения перенесены из `client/public` в `server/public/media`:

```
server/public/media/
  hero/            # hero-слайдер и сайдбар
  collections/     # карточки коллекций
  seo/hero.svg     # картинка SEO блока
  footer/yandex-…  # виджет рейтинга
```

Иконки UI и fallback-изображения (например, `/Goods/default.png`) остались в `client/public`,
так как они нужны на этапе сборки фронтенда.

Чтобы GitHub не блокировал pull request из-за бинарных файлов, все маркетинговые
картинки представлены в виде адаптируемых SVG-заглушек.

## Дальнейшее развитие

- Подключить настоящую БД или CMS вместо in-memory данных из `server/data`.
- Реализовать авторизацию для админ-панели и CRUD-операции поверх текущих структур.
- Перевести фронтенд на RTK Query или React Query для автоматического кэширования.
