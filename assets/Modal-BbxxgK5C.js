import{w as g,x as j,a as e,v as k,p as _}from"./chunk-UH6JLGW7-BuU8Z2XH.js";import{l as v,b as N}from"./apiSlise-CKyxjTQ5.js";import{a as b,R as y}from"./hooks-B-oP3_Sk.js";const S="_Modal_kdudh_1",D="_Modal__content_kdudh_30",w="_Modal__imgWrapper_kdudh_34",W="_Modal__img_kdudh_34",G="_Modal__contentWrapper_kdudh_55",I="_Modal__title_kdudh_74",U="_Modal__category_kdudh_89",E="_Modal__info_kdudh_98",H="_Modal__info__price_kdudh_102",C="_Modal__info__discount_kdudh_111",P="_Modal__info__country_kdudh_121",R="_Modal__description_kdudh_130",F="_Modal__signs_kdudh_141",$="_Modal__isHit_kdudh_147",O="_Modal__isDiscount_kdudh_156",Q="_Modal__close_kdudh_166",A="_Modal__forms_kdudh_197",B="_Modal__form__button_kdudh_219",T="_Modal__form__button__add_kdudh_236",q="_Modal__form__button__buy_kdudh_240",z="_Modal__wrapper_kdudh_244",a={Modal:S,Modal__content:D,Modal__imgWrapper:w,Modal__img:W,Modal__contentWrapper:G,Modal__title:I,Modal__category:U,Modal__info:E,Modal__info__price:H,Modal__info__discount:C,Modal__info__country:P,Modal__description:R,Modal__signs:F,Modal__isHit:$,Modal__isDiscount:O,Modal__close:Q,Modal__forms:A,Modal__form__button:B,Modal__form__button__add:T,Modal__form__button__buy:q,Modal__wrapper:z},Z=g(function(){const c=j(),{productId:s}=c,i=typeof s=="string",[r,d]=e.useState(!1),{data:u,isSuccess:M}=v(null),l=M?u.serverUrl:"",m="/GGPromarket/Goods/default.png",{data:o,isSuccess:p,isError:K,error:L}=N(`${s}`);b();const f=k();function h(){f("/",{preventScrollReset:!0})}async function t(x){if(x.preventDefault(),!l||!o)return;const n=new FormData;n.append("id",o.id.toString()),await fetch(`${l}/api/purchase`,{method:"POST",body:n})}return e.useEffect(()=>{d(!1)},[s]),_.jsx(_.Fragment,{children:i?_.jsx("div",{className:a.Modal__wrapper,children:_.jsxs("div",{className:a.Modal,children:[_.jsxs("div",{className:a.Modal__close,onClick:h,children:[_.jsx("span",{className:a.Modal__close__span}),_.jsx("span",{className:a.Modal__close__span})]}),p?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:a.Modal__imgWrapper,children:[_.jsx("img",{src:r?m:o.imgUrl,alt:o.name,className:a.Modal__img,onError:()=>{d(!0)}}),_.jsxs("div",{className:a.Modal__signs,children:[o.isHit?_.jsx("div",{className:a.Modal__isHit,children:"ХИТ"}):null,o.discount!=null&&o.discount<o.price?_.jsx("div",{className:a.Modal__isDiscount,children:"АКЦИЯ"}):null]})]}),_.jsxs("div",{className:a.Modal__contentWrapper,children:[_.jsxs("div",{className:a.Modal__content,children:[_.jsx("h3",{className:a.Modal__title,children:o.name}),_.jsx(y,{rateSum:o.rate,commentsSum:o.commentsSum}),_.jsx("div",{className:a.Modal__category,children:o.category}),_.jsxs("div",{className:a.Modal__info,children:[_.jsx("div",{className:a.Modal__info__price,children:o.discount!=null&&o.discount<o.price?o.discount+" ₽":o.price+" ₽"}),o.discount!=null&&o.discount<o.price?_.jsx("div",{className:a.Modal__info__discount,children:o.discount<o.price?o.price+" ₽":o.discount+" ₽"}):null,_.jsx("div",{className:a.Modal__info__country,children:o.country})]}),_.jsx("p",{className:a.Modal__description,children:o.description})]}),_.jsxs("div",{className:a.Modal__forms,children:[_.jsx("button",{onClick:t,className:a.Modal__form__button+" "+a.Modal__form__button__buy,children:"Купить сейчас"}),_.jsx("button",{onClick:t,className:a.Modal__form__button+" "+a.Modal__form__button__add,children:"В корзину"})]})]})]}):null]},s)}):null})});export{Z as default};
