import{a as n,x as W,p as o,v as A}from"./chunk-UH6JLGW7-C5_N2qaM.js";import{R as T}from"./ui-C_hnAzDc.js";import{a as Y,u as b}from"./hooks-c0Jm5PRv.js";import{a as C,t as O}from"./clientStates-Ijc_ZD4W.js";const U="_Goods__loading_ver2d_1",q="_Goods__error_ver2d_4",F="_GoodsSlider_ver2d_8",J="_GoodsSlider__categories_ver2d_15",K="_GoodsSlider__category_ver2d_24",Q="_selected_ver2d_32",X="_GoodsSlider__items__wrapper_ver2d_36",Z="_GoodsSlider__items__buttonLeft_ver2d_44",ee="_GoodsSlider__items__buttonRight_ver2d_53",oe="_GoodsSlider__noItems_ver2d_62",se="_GoodsItem_ver2d_70",te="_GoodsItem__signs_ver2d_95",_e="_GoodsItem__hitSign_ver2d_100",ne="_GoodsItem__discountSign_ver2d_109",re="_GoodsItem__image_ver2d_119",de="_GoodsItem__content_ver2d_122",ie="_GoodsItem__button_ver2d_143",ce="_GoodsItem__price_ver2d_163",le="_GoodsItem__discount_ver2d_109",ae="_GoodsItem__nullItem_ver2d_177",me="_GoodsItem__info_ver2d_181",ue="_GoodsItem__hoverBanner_ver2d_192",Ge="_GoodsItem__like_ver2d_206",Ie="_active_ver2d_216",ge="_GoodsItem__title_ver2d_216",s={Goods__loading:U,Goods__error:q,GoodsSlider:F,GoodsSlider__categories:J,GoodsSlider__category:K,selected:Q,GoodsSlider__items__wrapper:X,GoodsSlider__items__buttonLeft:Z,GoodsSlider__items__buttonRight:ee,GoodsSlider__noItems:oe,GoodsItem:se,GoodsItem__signs:te,GoodsItem__hitSign:_e,GoodsItem__discountSign:ne,GoodsItem__image:re,GoodsItem__content:de,GoodsItem__button:ie,GoodsItem__price:ce,GoodsItem__discount:le,GoodsItem__nullItem:ae,GoodsItem__info:me,GoodsItem__hoverBanner:ue,GoodsItem__like:Ge,active:Ie,GoodsItem__title:ge},x=e=>e.toString().split("").reverse().map((r,d)=>(d+1)%3===0&&d!==0?" "+r:r).reverse().join(""),ke=n.memo(({item:e,scrollContainer:r,productRoutePrefix:d="",locationSearch:i=""})=>{const[j,k]=n.useState(!1),[N,I]=n.useState(!1),[l,$]=n.useState(!1),a=n.useRef(null),m=n.useRef(null),u=n.useRef(null),R=W(),c=d.replace(/\/$/,"")||"",g=i?i.startsWith("?")?i:`?${i}`:"",v=`${c?`${c}/product/${e.id}`:`/product/${e.id}`}${g}`.replace(/\/\/+/g,"/"),y=c?`${c}${g}`:"/",S=Y(),w=b(t=>t.clientState.likedItems).includes(e.id),D=b(t=>t.clientState.cartItems).includes(e.id),p=x(e.price),_=typeof e.discount=="number"?e.discount:null,h=_!=null?x(_):null,f=_!=null&&e.price>0,E=o.jsx("p",{className:s.GoodsItem__discount,children:_!=null&&_>e.price?h:p+" ₽"}),L=o.jsx("div",{className:s.GoodsItem__nullItem}),P=o.jsx("div",{className:s.GoodsItem__discountSign,children:"АКЦИЯ"}),B=o.jsx("div",{className:s.GoodsItem__hitSign,children:"ХИТ"}),H=o.jsxs("div",{className:s.GoodsItem__signs,children:[e.isHit?B:null,f?P:null]});n.useEffect(()=>{if(!a.current||l)return;const t=a.current,G=new IntersectionObserver(M=>{const[V]=M;V.isIntersecting&&($(!0),G.unobserve(t))},{root:(r==null?void 0:r.current)??null,rootMargin:"300px",threshold:.1});return G.observe(t),()=>{G.disconnect()}},[l,r]);const z=t=>{if(t.preventDefault(),m.current&&t.target===m.current){S(C(e.id));return}if(u.current&&t.target===u.current){S(O(e.id));return}R(v,{preventScrollReset:!0,state:{returnTo:y,scrollY:window.scrollY}})};return o.jsxs(A,{ref:a,to:v,onMouseLeave:()=>I(!1),onMouseEnter:()=>I(!0),onClick:z,className:s.GoodsItem+" "+(N?s.active:""),children:[l?o.jsx("img",{className:s.GoodsItem__image,src:j?"/GGPromarket/Goods/default.webp":e.imgUrl,alt:"",onError:()=>k(!0)}):null,o.jsxs("div",{className:s.GoodsItem__content,children:[o.jsx(T,{rateSum:e.rate,commentsSum:e.commentsSum}),o.jsx("h4",{className:s.GoodsItem__title,children:e.name}),o.jsx("p",{className:s.GoodsItem__country,children:e.country}),o.jsxs("div",{className:s.GoodsItem__info,children:[o.jsx("p",{className:s.GoodsItem__price,children:_!=null&&_<e.price?h:p+" ₽"}),o.jsx("button",{ref:u,className:s.GoodsItem__button,children:D?"В корзине":"В корзину"}),_!=null?E:L]})]}),o.jsx("div",{className:s.GoodsItem__hoverBanner,children:"Быстрый просмотр"}),o.jsx("img",{ref:m,src:w?"/GGPromarket/Goods/liked.png":"/GGPromarket/Goods/like.svg",alt:"like",className:s.GoodsItem__like}),f||e.isHit?H:null]})});export{ke as G,s as S};
