import{p as e,a as d,R as A,v as $}from"./chunk-UH6JLGW7-BuU8Z2XH.js";import{T as x}from"./home-BaPH2kwH.js";import{u as F}from"./apiSlise-DyPyVMm8.js";import{R as H}from"./ui-DakXsL72.js";import{u as j,a as P}from"./hooks-ZVFlrzEq.js";import{a as T,t as M}from"./clientStates-2epOhWx_.js";import"./preload-helper-CR-aIV2P.js";const O="_Goods__loading_ver2d_1",J="_Goods__error_ver2d_4",V="_GoodsSlider_ver2d_8",Q="_GoodsSlider__categories_ver2d_15",U="_GoodsSlider__category_ver2d_24",W="_selected_ver2d_32",q="_GoodsSlider__items__wrapper_ver2d_36",z="_GoodsSlider__items__buttonLeft_ver2d_44",K="_GoodsSlider__items__buttonRight_ver2d_53",X="_GoodsSlider__noItems_ver2d_62",Y="_GoodsItem_ver2d_70",Z="_GoodsItem__signs_ver2d_95",ee="_GoodsItem__hitSign_ver2d_100",te="_GoodsItem__discountSign_ver2d_109",se="_GoodsItem__image_ver2d_119",oe="_GoodsItem__content_ver2d_122",re="_GoodsItem__button_ver2d_143",ie="_GoodsItem__price_ver2d_163",_e="_GoodsItem__discount_ver2d_109",ne="_GoodsItem__nullItem_ver2d_177",de="_GoodsItem__info_ver2d_181",le="_GoodsItem__hoverBanner_ver2d_192",ce="_GoodsItem__like_ver2d_206",ae="_active_ver2d_216",me="_GoodsItem__title_ver2d_216",t={Goods__loading:O,Goods__error:J,GoodsSlider:V,GoodsSlider__categories:Q,GoodsSlider__category:U,selected:W,GoodsSlider__items__wrapper:q,GoodsSlider__items__buttonLeft:z,GoodsSlider__items__buttonRight:K,GoodsSlider__noItems:X,GoodsItem:Y,GoodsItem__signs:Z,GoodsItem__hitSign:ee,GoodsItem__discountSign:te,GoodsItem__image:se,GoodsItem__content:oe,GoodsItem__button:re,GoodsItem__price:ie,GoodsItem__discount:_e,GoodsItem__nullItem:ne,GoodsItem__info:de,GoodsItem__hoverBanner:le,GoodsItem__like:ce,active:ae,GoodsItem__title:me},ue={hits:[{tag:"Sinks",text:"Раковины"},{tag:"Baths",text:"Ванны"},{tag:"Toilets",text:"Унитазы"},{tag:"Shower systems",text:"Душевые системы"},{tag:"Faucets",text:"Смесители"},{tag:"Mirrors",text:"Зеркала"},{tag:"Shower cabins",text:"Душевые кабины"},{tag:"Washing machines",text:"Стиральные машины"}],discounts:[{tag:"Faucets",text:"Смесители"},{tag:"Towel dryers",text:"Полотенцесушители"},{tag:"Bidets",text:"Биде"},{tag:"Shower systems",text:"Душевые системы"},{tag:"Baths",text:"Ванны"},{tag:"Toilets",text:"Унитазы"},{tag:"Heaters",text:"Обогреватели"},{tag:"Dishwashers",text:"Посудомоечные машины"}]},N=["hit","discount"];function je(){const{isSuccess:s,isError:c,error:a,data:n,isLoading:m}=F(null),l=s?n:"loading",_=ue;return e.jsxs(e.Fragment,{children:[e.jsx(x,{description:"Хиты продаж"}),e.jsxs("div",{className:t.Goods,children:[s?e.jsx(b,{categories:_.hits,data:l,sign:N[0]}):null,m?e.jsx("div",{className:t.Goods__loading,children:"Загрузка..."}):null,c?e.jsx("div",{className:t.Goods__error,children:JSON.stringify(a)}):null,e.jsx(x,{description:"Акции"}),s?e.jsx(b,{categories:_.discounts,data:l,sign:N[1]}):null,m?e.jsx("div",{className:t.Goods__loading,children:"Загрузка..."}):null,c?e.jsx("div",{className:t.Goods__error,children:JSON.stringify(a)}):null]})]})}function b({data:s,categories:c,sign:a}){const[n,m]=d.useState("All"),l=s.filter(o=>a==="hit"&&o.isHit||a==="discount"&&o.discount!=null&&o.price>=o.discount?n==="All"||o.category===n:!1),_=d.useRef(null);function g(o,G){G&&(o==="right"&&G.scrollBy({left:308,behavior:"smooth"}),o==="left"&&G.scrollBy({left:-308,behavior:"smooth"}))}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:t.GoodsSlider,children:[e.jsxs("div",{className:t.GoodsSlider__categories,children:[e.jsx("button",{onClick:()=>{m("All")},className:t.GoodsSlider__category+" "+(n==="All"?t.selected:""),children:"Любые товары"}),c.map(o=>e.jsx("div",{onClick:()=>{m(o.tag)},className:t.GoodsSlider__category+" "+(n===o.tag?t.selected:""),children:o.text},o.tag))]}),l.length>0?e.jsxs("div",{className:t.GoodsSlider__items,children:[e.jsx("div",{ref:_,className:t.GoodsSlider__items__wrapper,children:l.map(o=>e.jsx(Ge,{props:o,scrollEl:_},o.name))}),e.jsxs("div",{className:t.GoodsSlider__items__buttons,children:[e.jsx("button",{onClick:()=>g("left",_.current),className:t.GoodsSlider__items__buttonLeft,children:e.jsx("img",{className:t.GoodsSlider__items__button__img,src:"/GGPromarket/Goods/arrow.svg",alt:"arrow"})}),e.jsx("button",{onClick:()=>g("right",_.current),className:t.GoodsSlider__items__buttonRight,children:e.jsx("img",{className:t.GoodsSlider__items__button__img,src:"/GGPromarket/Goods/arrow.svg",alt:"arrow"})})]})]}):e.jsx("div",{className:t.GoodsSlider__noItems,children:"Товары не найдены"})]})})}const Ge=A.memo(({props:s,scrollEl:c})=>{const[a,n]=d.useState(!1),[m,l]=d.useState(!1),[_,g]=d.useState(!1),o=d.useRef(null),G=$(),I=s.price.toString().split("").reverse().map((r,i)=>(i+1)%3===0&&i!==0?" "+r:r).reverse().join(""),u=s.discount?s.discount.toString().split("").reverse().map((r,i)=>(i+1)%3===0&&i!==0?" "+r:r).reverse().join(""):null,S=s.discount!=null&&Number.isFinite(s.discount)&&s.price>0,k=e.jsx("p",{className:t.GoodsItem__discount,children:u!=null&&u>I?u:I+" ₽"}),y=e.jsx("div",{className:t.GoodsItem__nullItem}),p=e.jsx("div",{className:t.GoodsItem__discountSign,children:"АКЦИЯ"}),w=e.jsx("div",{className:t.GoodsItem__hitSign,children:"ХИТ"}),R=e.jsxs("div",{className:t.GoodsItem__signs,children:[s.isHit?w:null,S?p:null]});d.useEffect(()=>{if(!o.current||_)return;const r=o.current,i=new IntersectionObserver(D=>{const[E]=D;E.isIntersecting&&(g(!0),i.unobserve(r))},{root:c.current,rootMargin:"300px",threshold:.1});return i.observe(r),()=>{i.disconnect()}},[_,c]);const v=d.useRef(null),h=d.useRef(null),C=j(r=>r.clientState.likedItems).includes(s.id),B=j(r=>r.clientState.cartItems).includes(s.id),f=P();function L(r,i){v.current&&r.target===v.current?f(T(i)):h.current&&r.target===h.current?f(M(i)):G(`/product/${i}`,{preventScrollReset:!0})}return e.jsxs("a",{ref:o,href:s.href,onMouseLeave:()=>{l(!1)},onMouseEnter:()=>{l(!0)},onClick:r=>{r.preventDefault(),L(r,s.id)},className:t.GoodsItem+" "+(m?t.active:""),children:[_?e.jsx("img",{className:t.GoodsItem__image,src:a?"/GGPromarket/Goods/default.webp":s.imgUrl,alt:"",onError:()=>{n(!0)}}):null,e.jsxs("div",{className:t.GoodsItem__content,children:[e.jsx(H,{rateSum:s.rate,commentsSum:s.commentsSum}),e.jsx("h4",{className:t.GoodsItem__title,children:s.name}),e.jsx("p",{className:t.GoodsItem__country,children:s.country}),e.jsxs("div",{className:t.GoodsItem__info,children:[e.jsx("p",{className:t.GoodsItem__price,children:u!=null&&u<I?u:I+" ₽"}),e.jsx("button",{ref:h,className:t.GoodsItem__button,children:B?"В корзине":"В корзину"}),Number.isFinite(s.discount)?k:y]})]}),e.jsx("div",{className:t.GoodsItem__hoverBanner,children:"Быстрый просмотр"}),e.jsx("img",{ref:v,src:C?"/GGPromarket/Goods/liked.png":"/GGPromarket/Goods/like.svg",alt:"like",className:t.GoodsItem__like}),S||s.isHit?R:null]})});export{je as default};
