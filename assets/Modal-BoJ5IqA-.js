import{w as b,x as y,a as d,v as S,p as _}from"./chunk-UH6JLGW7-BuU8Z2XH.js";import{d as D,b as I}from"./apiSlise-DyPyVMm8.js";import{u as w,a as W}from"./hooks-ZVFlrzEq.js";import{R as C}from"./ui-DakXsL72.js";import{t as G}from"./clientStates-2epOhWx_.js";const U="_Modal_1p0iv_1",E="_Modal__content_1p0iv_30",H="_Modal__imgWrapper_1p0iv_34",k="_Modal__img_1p0iv_34",P="_Modal__contentWrapper_1p0iv_55",R="_Modal__title_1p0iv_74",F="_Modal__category_1p0iv_89",$="_Modal__info_1p0iv_98",A="_Modal__info__price_1p0iv_102",O="_Modal__info__discount_1p0iv_111",Q="_Modal__info__country_1p0iv_121",T="_Modal__description_1p0iv_130",B="_Modal__signs_1p0iv_141",q="_Modal__isHit_1p0iv_147",z="_Modal__isDiscount_1p0iv_156",J="_Modal__close_1p0iv_166",K="_Modal__forms_1p0iv_197",L="_Modal__form__button_1p0iv_219",V="_Modal__form__button__add_1p0iv_236",X="_Modal__form__button__buy_1p0iv_245",Y="_Modal__wrapper_1p0iv_254",a={Modal:U,Modal__content:E,Modal__imgWrapper:H,Modal__img:k,Modal__contentWrapper:P,Modal__title:R,Modal__category:F,Modal__info:$,Modal__info__price:A,Modal__info__discount:O,Modal__info__country:Q,Modal__description:T,Modal__signs:B,Modal__isHit:q,Modal__isDiscount:z,Modal__close:J,Modal__forms:K,Modal__form__button:L,Modal__form__button__add:V,Modal__form__button__buy:X,Modal__wrapper:Y},e_=b(function(){const c=y(),{productId:s}=c,l=Number(s),r=typeof s=="string",[p,n]=d.useState(!1),{data:u,isSuccess:M}=D(null),e=M?u.serverUrl:"",m="/GGPromarket/Goods/default.png",{data:o,isSuccess:f,isError:__,error:o_}=I(`${s}`),v=w(t=>t.clientState.cartItems).includes(l),g=W(),x=S();function h(){x("/",{preventScrollReset:!0})}async function j(t){if(t.preventDefault(),!e||!o)return;const i=new FormData;i.append("id",o.id.toString()),await fetch(`${e}/api/purchase`,{method:"POST",body:i})}function N(t){t.preventDefault(),g(G(l))}return d.useEffect(()=>{n(!1)},[s]),_.jsx(_.Fragment,{children:r?_.jsx("div",{className:a.Modal__wrapper,children:_.jsxs("div",{className:a.Modal,children:[_.jsxs("div",{className:a.Modal__close,onClick:h,children:[_.jsx("span",{className:a.Modal__close__span}),_.jsx("span",{className:a.Modal__close__span})]}),f?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:a.Modal__imgWrapper,children:[_.jsx("img",{src:p?m:o.imgUrl,alt:o.name,className:a.Modal__img,onError:()=>{n(!0)}}),_.jsxs("div",{className:a.Modal__signs,children:[o.isHit?_.jsx("div",{className:a.Modal__isHit,children:"ХИТ"}):null,o.discount!=null&&o.discount<o.price?_.jsx("div",{className:a.Modal__isDiscount,children:"АКЦИЯ"}):null]})]}),_.jsxs("div",{className:a.Modal__contentWrapper,children:[_.jsxs("div",{className:a.Modal__content,children:[_.jsx("h3",{className:a.Modal__title,children:o.name}),_.jsx(C,{rateSum:o.rate,commentsSum:o.commentsSum}),_.jsx("div",{className:a.Modal__category,children:o.category}),_.jsxs("div",{className:a.Modal__info,children:[_.jsx("div",{className:a.Modal__info__price,children:o.discount!=null&&o.discount<o.price?o.discount+" ₽":o.price+" ₽"}),o.discount!=null&&o.discount<o.price?_.jsx("div",{className:a.Modal__info__discount,children:o.discount<o.price?o.price+" ₽":o.discount+" ₽"}):null,_.jsx("div",{className:a.Modal__info__country,children:o.country})]}),_.jsx("p",{className:a.Modal__description,children:o.description})]}),_.jsxs("div",{className:a.Modal__forms,children:[_.jsx("button",{onClick:j,className:a.Modal__form__button+" "+a.Modal__form__button__buy,children:"Купить сейчас"}),_.jsx("button",{onClick:N,className:a.Modal__form__button+" "+a.Modal__form__button__add,children:v?"В корзине":"В корзину"})]})]})]}):null]},s)}):null})});export{e_ as default};
