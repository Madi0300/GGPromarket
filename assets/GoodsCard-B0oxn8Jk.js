import{a as n,v as V,p as o}from"./chunk-UH6JLGW7-xtm7V6Md.js";import{R as A}from"./ui-Bh3naldN.js";import{a as T,u as f}from"./hooks-SON3esK2.js";import{a as W,t as Y}from"./clientStates-Cqai_9ZR.js";const C="_Goods__loading_ver2d_1",O="_Goods__error_ver2d_4",U="_GoodsSlider_ver2d_8",q="_GoodsSlider__categories_ver2d_15",F="_GoodsSlider__category_ver2d_24",J="_selected_ver2d_32",K="_GoodsSlider__items__wrapper_ver2d_36",Q="_GoodsSlider__items__buttonLeft_ver2d_44",X="_GoodsSlider__items__buttonRight_ver2d_53",Z="_GoodsSlider__noItems_ver2d_62",ee="_GoodsItem_ver2d_70",oe="_GoodsItem__signs_ver2d_95",se="_GoodsItem__hitSign_ver2d_100",te="_GoodsItem__discountSign_ver2d_109",_e="_GoodsItem__image_ver2d_119",ne="_GoodsItem__content_ver2d_122",re="_GoodsItem__button_ver2d_143",de="_GoodsItem__price_ver2d_163",ie="_GoodsItem__discount_ver2d_109",ce="_GoodsItem__nullItem_ver2d_177",le="_GoodsItem__info_ver2d_181",ae="_GoodsItem__hoverBanner_ver2d_192",me="_GoodsItem__like_ver2d_206",ue="_active_ver2d_216",Ge="_GoodsItem__title_ver2d_216",s={Goods__loading:C,Goods__error:O,GoodsSlider:U,GoodsSlider__categories:q,GoodsSlider__category:F,selected:J,GoodsSlider__items__wrapper:K,GoodsSlider__items__buttonLeft:Q,GoodsSlider__items__buttonRight:X,GoodsSlider__noItems:Z,GoodsItem:ee,GoodsItem__signs:oe,GoodsItem__hitSign:se,GoodsItem__discountSign:te,GoodsItem__image:_e,GoodsItem__content:ne,GoodsItem__button:re,GoodsItem__price:de,GoodsItem__discount:ie,GoodsItem__nullItem:ce,GoodsItem__info:le,GoodsItem__hoverBanner:ae,GoodsItem__like:me,active:ue,GoodsItem__title:Ge},b=e=>e.toString().split("").reverse().map((r,i)=>(i+1)%3===0&&i!==0?" "+r:r).reverse().join(""),fe=n.memo(({item:e,scrollContainer:r,productRoutePrefix:i="",locationSearch:c=""})=>{const[x,j]=n.useState(!1),[k,g]=n.useState(!1),[m,N]=n.useState(!1),u=n.useRef(null),G=n.useRef(null),I=n.useRef(null),$=V(),v=T(),R=f(t=>t.clientState.likedItems).includes(e.id),y=f(t=>t.clientState.cartItems).includes(e.id),S=b(e.price),_=typeof e.discount=="number"?e.discount:null,p=_!=null?b(_):null,h=_!=null&&e.price>0,w=o.jsx("p",{className:s.GoodsItem__discount,children:_!=null&&_>e.price?p:S+" ₽"}),D=o.jsx("div",{className:s.GoodsItem__nullItem}),E=o.jsx("div",{className:s.GoodsItem__discountSign,children:"АКЦИЯ"}),P=o.jsx("div",{className:s.GoodsItem__hitSign,children:"ХИТ"}),L=o.jsxs("div",{className:s.GoodsItem__signs,children:[e.isHit?P:null,h?E:null]});n.useEffect(()=>{if(!u.current||m)return;const t=u.current,l=new IntersectionObserver(d=>{const[a]=d;a.isIntersecting&&(N(!0),l.unobserve(t))},{root:(r==null?void 0:r.current)??null,rootMargin:"300px",threshold:.1});return l.observe(t),()=>{l.disconnect()}},[m,r]);const B=t=>{if(t.preventDefault(),G.current&&t.target===G.current){v(W(e.id));return}if(I.current&&t.target===I.current){v(Y(e.id));return}const d=i.replace(/\/$/,"")||"",a=c?c.startsWith("?")?c:`?${c}`:"",H=`${d?`${d}/product/${e.id}`:`/product/${e.id}`}${a}`,z=d?`${d}${a}`:"/",M=H.replace(/\/\/+/g,"/");$(M,{preventScrollReset:!0,state:{returnTo:z,scrollY:window.scrollY}})};return o.jsxs("a",{ref:u,href:e.href,onMouseLeave:()=>g(!1),onMouseEnter:()=>g(!0),onClick:B,className:s.GoodsItem+" "+(k?s.active:""),children:[m?o.jsx("img",{className:s.GoodsItem__image,src:x?"/GGPromarket/Goods/default.webp":e.imgUrl,alt:"",onError:()=>j(!0)}):null,o.jsxs("div",{className:s.GoodsItem__content,children:[o.jsx(A,{rateSum:e.rate,commentsSum:e.commentsSum}),o.jsx("h4",{className:s.GoodsItem__title,children:e.name}),o.jsx("p",{className:s.GoodsItem__country,children:e.country}),o.jsxs("div",{className:s.GoodsItem__info,children:[o.jsx("p",{className:s.GoodsItem__price,children:_!=null&&_<e.price?p:S+" ₽"}),o.jsx("button",{ref:I,className:s.GoodsItem__button,children:y?"В корзине":"В корзину"}),_!=null?w:D]})]}),o.jsx("div",{className:s.GoodsItem__hoverBanner,children:"Быстрый просмотр"}),o.jsx("img",{ref:G,src:R?"/GGPromarket/Goods/liked.png":"/GGPromarket/Goods/like.svg",alt:"like",className:s.GoodsItem__like}),h||e.isHit?L:null]})});export{fe as G,s as S};
